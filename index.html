
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

        <title>Cover Template for Bootstrap</title>

        <!-- Bootstrap core CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/keyboard.css" rel="stylesheet">
        <!-- Custom styles for this template -->
        <link href="css/cover.css" rel="stylesheet">

        <!-- Just for debugging purposes. Don't actually copy this line! -->
        <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="site-wrapper">

            <div class="site-wrapper-inner">

                <div class="cover-container">
                    <!--Заставка-->
                    <img src="img/fromVk.jpg" width="200" height="200" id='logo'>
                    <div class="inner cover frames" id="frame_1">

                        <h1 class="cover-heading">Моментально рассчитать условия<br/><span> по кредиту или вкладу</span></h1>            
                        <p class="lead">
                            <a href="#" class="btn btn-lg btn-success">ДА</a>
                        </p>
                    </div>
                    <!--Выбор субъекта-->
                    <div class="inner cover frames" id="frame_2">                        
                        <h1 class="cover-heading">Выбирите условия кредитования:</h1>            
                        <p class="lead">
                            <a href="#" class="btn fiz btn-lg btn-success">Физическое лицо</a>
                            <a href="#" class="btn ur btn-lg btn-success">Юридическое лицо</a>
                        </p>
                    </div>
                    <!--Физическое лицо-->
                    <!--Программа кредитования-->
                    <div class="inner cover frames" id="frame_3">                        
                        <h1 class="cover-heading">Выбирите программу кредитования:</h1>            
                        <p class="lead">
                            <a href="#" class="btn kredit btn-lg btn-success">Кредит на любые цели</a>
                            <a href="#" class="btn avto btn-lg btn-default">Автокредит</a><br/><br/>
                            <a href="#" class="btn ipoteka btn-lg btn-default">Ипотека</a>
                            <a href="#" class="btn vklad btn-lg btn-default">Вклад</a><br/>
                        </p>
                    </div>
                    <div class="inner cover frames" id="frame_4">                        
                        <h1 class="cover-heading">Основной источник дохода:</h1>            
                        <p class="lead">
                            <label><input type='radio' name='dohod' value='1' checked="checked"> Вы - работник по найму</label><br/>
                            <label><input type='radio' name='dohod' value='2'> Вы – индивидуальный предприниматель</label><br/>
                            <label><input type='radio' name='dohod' value='3'> Вы - учредитель юридического лица</label>
                        </p>
                        <h1 class="cover-heading">Сумма:</h1>
                        <p class="lead">
                            <input id="num" name='sum' class="alignRight" type="text" value='' placeholder="минимальная сумма кредита 150000,01">
                        </p>
                        <h1 class="cover-heading">Выбор обеспечения:</h1>
                        <p class="lead">
                            <label><input type='radio' name='obesp' value='1' checked="checked"> Без обеспечения</label><br/>
                            <label><input type='radio' name='obesp' value='2'> Залог транспортного средства</label><br/>                            
                            <label id='strahovkaImushestva'><input type="checkbox" name='strahovkaImushestva' checked="checked"> Застраховать имущество</label><br/>
                        </p>
                        <p class="lead">
                            <label id='strahovkaLichnosti'><input type="checkbox" name='strahovkaLichnosti' checked="checked"> Личное страхование</label><br/>
                            <Span>Выберите срок кредита</span>&nbsp;&nbsp;
                            <select id='selectTime' style="width:50px;">                                
                                <option value="24" selected="selected">24</option>
                                <option value="36">36</option>
                                <option value="48">48</option>
                                <option value="60">60</option>
                                <option value="72">72</option>
                                <option value="84">84</option>
                            </select>
                        </p>                        
                        <div class="panel panel-success" id="itog">
                            <div class="panel-heading">
                                <h3 class="panel-title">Расчет кредита</h3>
                            </div>
                            <div class="panel-body">
                                <p>Сумма кредита: <span id="i_sum"></span></p>
                                <p>Срок кредита: <span id="i_time"></span></p>
                                <p>Процентная ставка: <span id="i_procent"></span></p>
                                <p>Ежемесячный платеж: <span id="i_plateg"></span></p>      
                                <p>Всего к выплате: <span id="i_itog"></span></p>
                            </div>
                        </div>
                    </div>
                    <div class="mastfoot">
                        <div class="inner">
                            <p><img src="img/bottom.png" width="600"></p>
                        </div>
                    </div>

                </div>

            </div>

        </div>

        <!-- Bootstrap core JavaScript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="js/jquery.min.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/docs.min.js"></script>

        <script src="js/keyboard/jquery.keyboard.js"></script>
        <script>
            var flagMax = false;
            var kredit;
            if ($("label#strahovkaImushestva input").attr('checked')) {
                flagMax = true;
            } else {
                flagMax = false;
            }
            /*начальные данные 150000.01*/
            function getSum(sum) {
                if (sum === '') {
                    s = 0;
                } else {
                    s = parseFloat(sum);
                }
                if (s === '' || s < 150000.01) {
                    return 150000.01;
                }
                else if (s > 500000 && !flagMax) {
                    return 500000;
                } else {
                    return s;

                }
                return "error";
            }
            function fillSpanItog(k) {
                console.table([{"время кредита": k.t,
                        "сумма": k.kr, "% за месяц": k.st, "процент": pr,
                        "платеж": k.pli, "полная сумма": k.psk, "полные проценты": k.pkr}]);
                $("span#i_sum").html(k.kr);
                $("span#i_time").html(k.t);
                $("span#i_procent").html(pr + "%");
                $("span#i_plateg").html(k.pli.toFixed(2) + " руб./мес.");
                $("span#i_itog").html(k.psk.toFixed(2) + " руб.");
            }
            function fillKredit(time, sum) {
                /*проверка обеспечения*/
                //console.log($("input[name=obesp]:checked").val());
                if ($("input[name=obesp]:checked").val() == 1) {
                    pr = 20.5 + 1; //так  как нет возможности узнать кредитную историю
                } else {
                    pr = 16.0 + 1; //так  как нет возможности узнать кредитную историю

                }
                //console.log($("input[name=strahovkaImushestva]:checked").attr("checked"));
                if ($("input[name=strahovkaImushestva]:checked").attr("checked") == undefined) {
                    pr = pr + 2;
                }
                if ($("input[name=strahovkaLichnosti]:checked").attr("checked") == undefined) {
                    pr = pr + 3;
                }
                /*проверка страховки*/
                kredit = {
                    t: parseInt(time), //кол-во периодов оплаты
                    kr: getSum(sum), //сумма кредита
                    st: pr / (12 * 100), //процентная ставка, начисляемая на задолженность за период;
                    pli: 0, //размер платежа за i - й период (i принимает значения от 1 до T); 
                    pkr: 0, //сумма процентов, выплаченных по кредиту за весь срок кредитования.                                                                   
                    psk: 0, //полная сумма кредита
                    pr: pr
                };

                //Плi = Кр*Ст / (1 - 1 / (1+Ст)^T) 
                //(1+Ст)^T
                temp1 = Math.pow((1 + kredit.st), kredit.t);
                kredit.pli = kredit.st * kredit.kr / (1 - 1 / temp1); //расчет ежемесячного платежа
                kredit.psk = kredit.pli * kredit.t;
                kredit.pkr = kredit.pli * kredit.t - kredit.kr;
                console.table([{"время кредита": kredit.t,
                        "сумма": kredit.kr, "% за месяц": kredit.st, "процент": pr,
                        "платеж": kredit.pli, "полная сумма": kredit.psk, "полные проценты": kredit.pkr}]);
                fillSpanItog(kredit);
                addC();
            }
            function addC() {
                $(".panel").addClass("panel-warning", 1, callback);
                return false;
            }
            function callback() {
                setTimeout(function() {
                    $(".panel").removeClass("panel-warning",1000);
                }, 1500);
            }
            fillKredit($("#selectTime").val(), $("input[name=sum]").val());




            /*первый уходит, второй приходит*/
            $("#frame_1 .btn").click(function() {
                $("#frame_1").hide("drop", {direction: "left"}, "slow", function() {
                    $("#frame_2").show("drop", {direction: "right"}, 'slow');
                });
            });
            /*второй уходит, приходит физическое*/
            $("#frame_2 .fiz").click(function() {
                $("#frame_2").hide("drop", {direction: "left"}, "slow", function() {
                    $("#frame_3").show("drop", {direction: "right"}, 'slow');
                });
            });
            /*уходит физичиское, приходит расчет для кредита на любые цели*/
            $("#frame_3 .kredit").click(function() {
                $("#frame_3").hide("drop", {direction: "left"}, "slow", function() {
                    $("#frame_4").show("drop", {direction: "right"}, 'slow');
                    $("#logo").hide();
                });
            });
            /*Для страховки имущества*/
            $("#frame_4 input[name='obesp']").click(function() {
                if ($(this).val() == 1) {
                    $("label#strahovkaImushestva").hide();
                } else if ($(this).val() == 2) {
                    $("label#strahovkaImushestva").show();
                }
            });

            $("#frame_4 input[name='obesp']").change(function() {
                fillKredit($("#selectTime").val(), $("input[name=sum]").val());
            });

            $("input[name=sum]").change(function() {
                fillKredit($("#selectTime").val(), $("input[name=sum]").val());
            });
            $("input[name=strahovkaImushestva]").change(function() {
                fillKredit($("#selectTime").val(), $("input[name=sum]").val());
            });
            $("input[name=strahovkaLichnosti]").change(function() {
                fillKredit($("#selectTime").val(), $("input[name=sum]").val());
            });

// Script 
            $('#num')
                    .keyboard({
                        layout: 'num',
                        restrictInput: false, // Prevent keys not in the displayed keyboard from being typed in 
                        preventPaste: true, // prevent ctrl-v and right click 
                        autoAccept: true
                    });
            /*.addTyping()*/;
        </script>

    </body>
</html>
